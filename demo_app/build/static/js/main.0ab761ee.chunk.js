(window.webpackJsonpfront_newsfeed=window.webpackJsonpfront_newsfeed||[]).push([[0],{148:function(e,t,n){e.exports=n(318)},153:function(e,t,n){},317:function(e,t,n){},318:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(8),s=n.n(i),c=(n(153),n(52)),o=n(35),l=n(36),u=n(38),d=n(37),h=n(39),p=n(321),m=n(325),f=n(320),b=n(142),v=n(13),w=n(100),g=n.n(w),S=n(51),y=n.n(S),E=n(129),O=n(322),j=n(324),F=n(143),D=n(319),C=n(323),N=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={inputData:"",visible:!1},n.hide=function(){n.setState({visible:!1})},n.handleVisibleChange=function(e){n.setState({visible:e})},n.handleInputChange=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,r=t.name;n.setState(Object(E.a)({},r,a))},n.handleInputDataFormSubmit=function(e){n.props.handleSendEvent(e,n.state.inputData),n.hide(),n.setState((function(){return{inputData:""}}))},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=r.a.createElement(O.a,{layout:"inline",onSubmit:function(t){return e.handleInputDataFormSubmit(t)}},r.a.createElement(O.a.Item,null,r.a.createElement(j.a,{placeholder:"New event",name:"inputData",onChange:this.handleInputChange,value:this.state.inputData})),r.a.createElement(O.a.Item,null,r.a.createElement(F.a,{type:"primary",htmlType:"submit"},"Send event")));return r.a.createElement(D.a,{content:t,title:"New event",trigger:"click",visible:this.state.visible,onVisibleChange:this.handleVisibleChange},r.a.createElement(v.a,{type:"edit",key:"edit"}))}}]),t}(r.a.Component),k=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={inputData:"",visible:!1},n.hide=function(){n.setState({visible:!1})},n.handleVisibleChange=function(e){n.setState({visible:e})},n.handleInputChange=function(e){n.setState({inputData:e})},n.handleInputDataFormSubmit=function(e){n.props.handleSubscribe(e,n.state.inputData),n.hide(),n.setState((function(){return{inputData:""}}))},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=r.a.createElement(O.a,{layout:"inline",onSubmit:function(t){return e.handleInputDataFormSubmit(t)}},r.a.createElement(O.a.Item,{label:"Select"},r.a.createElement(C.a,{style:{width:200},placeholder:"Select a newsfeed",value:this.state.inputData,onChange:this.handleInputChange},Object.entries(this.props.newsFeeds).map((function(t){var n=Object(c.a)(t,2),a=n[0],i=n[1];if(a!==e.props.newsFeedId)return r.a.createElement(C.a.Option,{key:a,value:a},i.name)})))),r.a.createElement(O.a.Item,null,r.a.createElement(F.a,{type:"primary",htmlType:"submit"},"Subscribe")));return r.a.createElement(D.a,{content:t,title:"Subscribe",trigger:"click",visible:this.state.visible,onVisibleChange:this.handleVisibleChange},r.a.createElement(v.a,{type:"ellipsis",key:"ellipsis"}))}}]),t}(r.a.Component),I=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={inputData:"",visible:!1},n.hide=function(){n.setState({visible:!1})},n.handleVisibleChange=function(e){n.setState({visible:e})},n.handleInputChange=function(e){n.setState({inputData:e})},n.handleInputDataFormSubmit=function(e){n.props.handleUnsubscribe(e,n.state.inputData),n.hide(),n.setState((function(){return{inputData:""}}))},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=r.a.createElement(O.a,{layout:"inline",onSubmit:function(t){return e.handleInputDataFormSubmit(t)}},r.a.createElement(O.a.Item,{label:"Select"},r.a.createElement(C.a,{style:{width:200},placeholder:"Select a newsfeed",value:this.state.inputData,onChange:this.handleInputChange},this.props.subscriptions.map((function(t){if(e.props.newsFeeds[t.to_newsfeed_id])return r.a.createElement(C.a.Option,{key:t.id,value:t.id},e.props.newsFeeds[t.to_newsfeed_id].name)})))),r.a.createElement(O.a.Item,null,r.a.createElement(F.a,{type:"primary",htmlType:"submit"},"Unsubscribe")));return r.a.createElement(D.a,{content:t,title:"Handle Subscriptions",trigger:"click",visible:this.state.visible,onVisibleChange:this.handleVisibleChange,onClick:this.props.getSubscriptions},r.a.createElement(v.a,{type:"setting",key:"setting"}))}}]),t}(r.a.Component),x=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={events:[],subscriptions:[]},n.getEvents=function(){var e="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/events/");fetch(e).then((function(e){return e.json()})).then((function(e){n.setState((function(){return{events:e.results}}))})).catch((function(e){return console.error("Bad request:",e)}))},n.getSubscriptions=function(){var e="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/subscriptions/");fetch(e).then((function(e){return e.json()})).then((function(e){n.setState((function(){return{subscriptions:e.results}}))})).catch((function(e){return console.error("Bad request:",e)}))},n.handleSendEvent=function(e,t){if(e.preventDefault(),!t)return!1;var a="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/events/"),r={data:{field_1:t}};fetch(a,{method:"POST",mode:"no-cors",body:JSON.stringify(r),headers:{Accept:"application/json","Content-Type":"application/json"}}).catch((function(e){return console.error("Bad request:",e)})),n.props.refreshNewsFeeds()},n.handleDeleteEvent=function(e){var t="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/events/").concat(e,"/");g.a.delete(t).catch((function(e){return console.error("Bad request:",e)})),n.props.refreshNewsFeeds()},n.handleSubscribe=function(e,t){if(e.preventDefault(),!t)return!1;var a="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/subscriptions/"),r={to_newsfeed_id:t};fetch(a,{method:"POST",mode:"no-cors",body:JSON.stringify(r),headers:{Accept:"application/json","Content-Type":"application/json"}}).catch((function(e){return console.error("Bad request:",e)}))},n.handleUnsubscribe=function(e,t){if(e.preventDefault(),!t)return!1;var a="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/subscriptions/").concat(t,"/");g.a.delete(a).catch((function(e){return console.error("Bad request:",e)}))},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getEvents(),this.getSubscriptions()}},{key:"render",value:function(){var e=this;return r.a.createElement(p.a,{key:this.props.index,title:this.props.value.name,extra:r.a.createElement(m.a,{count:this.state.events.length,showZero:!0,style:{backgroundColor:"#fff",color:"#999",boxShadow:"0 0 0 1px #d9d9d9 inset"}}),hoverable:!0,style:{width:220,marginTop:4},actions:[r.a.createElement(N,{handleSendEvent:this.handleSendEvent}),r.a.createElement(k,{handleSubscribe:this.handleSubscribe,newsFeeds:this.props.newsFeeds,newsFeedId:this.props.index}),r.a.createElement(I,{handleSubscribe:this.handleSubscribe,subscriptions:this.state.subscriptions,getSubscriptions:this.getSubscriptions,newsFeeds:this.props.newsFeeds,handleUnsubscribe:this.handleUnsubscribe})]},r.a.createElement("div",{style:{overflow:"auto",height:200}},this.state.events.map((function(t){return r.a.createElement(f.a,{key:t.id,content:r.a.createElement("p",null,t.data.field_1),datetime:r.a.createElement(b.a,{title:y.a.unix(t.published_at).format("YYYY-MM-DD HH:mm:ss")},r.a.createElement("span",null,y.a.unix(t.published_at).format("YYYY-MM-DD HH:mm:ss")),r.a.createElement("span",null,r.a.createElement(v.a,{type:"delete",theme:"twoTone",style:{fontSize:14,marginLeft:15,cursor:"pointer"},onClick:function(){return e.handleDeleteEvent(t.id)}})))})}))))}}]),t}(r.a.Component),_=function(){return Math.random().toString(36).substring(2)+(new Date).getTime().toString(36)},T=(n(316),n(317),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={newsFeeds:{}},n.createNewsFeed=function(){n.setState((function(e){var t=e.newsFeeds,n=_();return t[n]={name:"NF-".concat(n.substring(0,3))},localStorage.setItem("myNewsFeeds",JSON.stringify(t)),{newsFeeds:t}}))},n.refreshNewsFeeds=function(){for(var e=function(){var e=a[t],r=Object(c.a)(e,1)[0];setTimeout((function(){return n.refs[r].getEvents()}),750)},t=0,a=Object.entries(n.refs);t<a.length;t++){e()}},n.clearNewsFeedsStorage=function(){localStorage.clear(),n.setState((function(){return{newsFeeds:{}}}))},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("myNewsFeeds")?Object.entries(JSON.parse(localStorage.getItem("myNewsFeeds"))):[],t={},n=!0,a=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var o=i.value,l=Object(c.a)(o,2),u=l[0],d=l[1];t[u]=d}}catch(h){a=!0,r=h}finally{try{n||null==s.return||s.return()}finally{if(a)throw r}}this.setState((function(){return{newsFeeds:t}}))}},{key:"render",value:function(){var e,t=this,n=localStorage.getItem("myNewsFeeds")?Object.entries(JSON.parse(localStorage.getItem("myNewsFeeds"))):[];return e=n.length<6?r.a.createElement("button",{className:"btn-minimal",onClick:this.createNewsFeed},"Create NewsFeed"):r.a.createElement("button",{className:"btn-minimal",disabled:!0},"Max created"),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"row text-center"},r.a.createElement("div",{className:"col-md-5 text-left"},e),r.a.createElement("div",{className:"col-md-5 text-left"},r.a.createElement("button",{className:"btn-minimal",onClick:this.clearNewsFeedsStorage},"Clear Storage"))),r.a.createElement("div",{className:"row newsfeeds-card"},n.map((function(e){var n=Object(c.a)(e,2),a=n[0],i=n[1];return r.a.createElement("div",{key:a,className:"col-md-4"},r.a.createElement(x,{index:a,key:a,value:i,newsFeeds:t.state.newsFeeds,refreshNewsFeeds:t.refreshNewsFeeds,ref:a}))}))))}}]),t}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[148,1,2]]]);
//# sourceMappingURL=main.0ab761ee.chunk.js.map