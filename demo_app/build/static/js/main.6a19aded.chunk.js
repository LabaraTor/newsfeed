(window.webpackJsonpfront_newsfeed=window.webpackJsonpfront_newsfeed||[]).push([[0],{148:function(e,t,n){e.exports=n(318)},153:function(e,t,n){},317:function(e,t,n){},318:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),r=n(8),s=n.n(r),c=(n(153),n(61)),o=n(35),l=n(36),u=n(38),h=n(37),p=n(39),d=n(321),m=n(13),b=n(320),f=n(142),v=n(128),g=n.n(v),y=n(51),S=n.n(y),w=n(129),E=n(322),O=n(324),j=n(143),C=n(319),D=n(323),F=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={inputData:"",visible:!1},n.hide=function(){n.setState({visible:!1})},n.handleVisibleChange=function(e){n.setState({visible:e})},n.handleInputChange=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,i=t.name;n.setState(Object(w.a)({},i,a))},n.handleInputDataFormSubmit=function(e){n.props.handleSendEvent(e,n.state.inputData),n.hide(),n.setState((function(){return{inputData:""}}))},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=i.a.createElement(E.a,{layout:"inline",onSubmit:function(t){return e.handleInputDataFormSubmit(t)}},i.a.createElement(E.a.Item,null,i.a.createElement(O.a,{placeholder:"New event",name:"inputData",onChange:this.handleInputChange,value:this.state.inputData})),i.a.createElement(E.a.Item,null,i.a.createElement(j.a,{type:"primary",htmlType:"submit"},"Send event")));return i.a.createElement(C.a,{content:t,title:"New event",trigger:"click",visible:this.state.visible,onVisibleChange:this.handleVisibleChange},i.a.createElement(m.a,{type:"edit",key:"edit"}))}}]),t}(i.a.Component),k=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={inputData:"",visible:!1},n.hide=function(){n.setState({visible:!1})},n.handleVisibleChange=function(e){n.setState({visible:e})},n.handleInputChange=function(e){n.setState({inputData:e})},n.handleInputDataFormSubmit=function(e){n.props.handleSubscribe(e,n.state.inputData),n.hide(),n.setState((function(){return{inputData:""}}))},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=i.a.createElement(E.a,{layout:"inline",onSubmit:function(t){return e.handleInputDataFormSubmit(t)}},i.a.createElement(E.a.Item,{label:"Select"},i.a.createElement(D.a,{style:{width:200},placeholder:"Select a newsfeed",value:this.state.inputData,onChange:this.handleInputChange},Object.entries(this.props.newsFeeds).map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return i.a.createElement(D.a.Option,{key:n,value:n},a.name)})))),i.a.createElement(E.a.Item,null,i.a.createElement(j.a,{type:"primary",htmlType:"submit"},"Subscribe")));return i.a.createElement(C.a,{content:t,trigger:"click",visible:this.state.visible,onVisibleChange:this.handleVisibleChange},i.a.createElement(m.a,{type:"ellipsis",key:"ellipsis"}))}}]),t}(i.a.Component),N=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={inputData:"",visible:!1},n.hide=function(){n.setState({visible:!1})},n.handleVisibleChange=function(e){n.setState({visible:e})},n.handleInputChange=function(e){n.setState({inputData:e})},n.handleInputDataFormSubmit=function(e){n.props.handleUnsubscribe(e,n.state.inputData),n.hide(),n.setState((function(){return{inputData:""}}))},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=i.a.createElement(E.a,{layout:"inline",onSubmit:function(t){return e.handleInputDataFormSubmit(t)}},i.a.createElement(E.a.Item,{label:"Select"},i.a.createElement(D.a,{style:{width:200},placeholder:"Select a newsfeed",value:this.state.inputData,onChange:this.handleInputChange},this.props.subscriptions.map((function(t){if(e.props.newsFeeds[t.to_newsfeed_id])return i.a.createElement(D.a.Option,{key:t.id,value:t.id},e.props.newsFeeds[t.to_newsfeed_id].name)})))),i.a.createElement(E.a.Item,null,i.a.createElement(j.a,{type:"primary",htmlType:"submit"},"Unsubscribe")));return i.a.createElement(C.a,{content:t,trigger:"click",visible:this.state.visible,onVisibleChange:this.handleVisibleChange,onClick:this.props.getSubscriptions},i.a.createElement(m.a,{type:"setting",key:"setting"}))}}]),t}(i.a.Component),I=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={events:[],subscriptions:[]},n.getEvents=function(){var e="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/events/");fetch(e).then((function(e){return e.json()})).then((function(e){n.setState((function(){return{events:e.results}}))})).catch((function(e){return console.error("Bad request:",e)}))},n.getSubscriptions=function(){var e="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/subscriptions/");fetch(e).then((function(e){return e.json()})).then((function(e){n.setState((function(){return{subscriptions:e.results}}))})).catch((function(e){return console.error("Bad request:",e)}))},n.handleSendEvent=function(e,t){if(e.preventDefault(),!t)return!1;var a="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/events/"),i={data:{field_1:t}};fetch(a,{method:"POST",mode:"no-cors",body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json"}}).catch((function(e){return console.error("Bad request:",e)})),setTimeout((function(){return fetch(a).then((function(e){return e.json()})).then((function(e){n.setState((function(){return{events:e.results}}))})).catch((function(e){return console.error("Bad request:",e)}))}),1e3)},n.handleSubscribe=function(e,t){if(e.preventDefault(),!t)return!1;var a="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/subscriptions/"),i={to_newsfeed_id:t};fetch(a,{method:"POST",mode:"no-cors",body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json"}}).catch((function(e){return console.error("Bad request:",e)}))},n.handleUnsubscribe=function(e,t){if(e.preventDefault(),!t)return!1;var a="http://127.0.0.1:8000/api/newsfeed/".concat(n.props.index,"/subscriptions/").concat(t,"/");g.a.delete(a).catch((function(e){return console.error("Bad request:",e)}))},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getEvents(),this.getSubscriptions()}},{key:"render",value:function(){return i.a.createElement(d.a,{key:this.props.index,title:this.props.value.name,extra:i.a.createElement(m.a,{type:"sync",onClick:this.getEvents}),hoverable:!0,style:{width:250},actions:[i.a.createElement(N,{handleSubscribe:this.handleSubscribe,subscriptions:this.state.subscriptions,getSubscriptions:this.getSubscriptions,newsFeeds:this.props.newsFeeds,handleUnsubscribe:this.handleUnsubscribe}),i.a.createElement(F,{handleSendEvent:this.handleSendEvent}),i.a.createElement(k,{handleSubscribe:this.handleSubscribe,newsFeeds:this.props.newsFeeds})]},i.a.createElement("div",{style:{overflow:"auto",height:250}},this.state.events.map((function(e){return i.a.createElement(b.a,{key:e.id,content:i.a.createElement("p",null,e.data.field_1),datetime:i.a.createElement(f.a,{title:S.a.unix(e.published_at).format("YYYY-MM-DD HH:mm:ss")},i.a.createElement("span",null,S.a.unix(e.published_at).format("YYYY-MM-DD HH:mm:ss")))})}))))}}]),t}(i.a.Component),x=function(){return Math.random().toString(36).substring(2)+(new Date).getTime().toString(36)},_=(n(316),n(317),function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={newsFeeds:{}},n.createNewsFeed=function(){n.setState((function(e){var t=e.newsFeeds,n=x();return t[n]={name:"NF-".concat(n.substring(0,3))},localStorage.setItem("myNewsFeeds",JSON.stringify(t)),{newsFeeds:t}}))},n.clearNewsFeedsStorage=function(){localStorage.clear(),n.setState((function(){return{newsFeeds:{}}}))},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("myNewsFeeds")?Object.entries(JSON.parse(localStorage.getItem("myNewsFeeds"))):[];console.log(e);var t={},n=!0,a=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var o=r.value,l=Object(c.a)(o,2),u=l[0],h=l[1];t[u]=h}}catch(p){a=!0,i=p}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}this.setState((function(){return{newsFeeds:t}}))}},{key:"render",value:function(){var e=this,t=localStorage.getItem("myNewsFeeds")?Object.entries(JSON.parse(localStorage.getItem("myNewsFeeds"))):[];return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"row text-center"},i.a.createElement("div",{className:"col-md-4"},i.a.createElement("button",{className:"btn-minimal",onClick:this.createNewsFeed},"Create NewsFeed")),i.a.createElement("div",{className:"col-md-4"},i.a.createElement("button",{className:"btn-minimal",onClick:this.clearNewsFeedsStorage},"Clear Storage"))),i.a.createElement("div",{className:"row newsfeeds-card"},t.map((function(t){var n=Object(c.a)(t,2),a=n[0],r=n[1];return i.a.createElement("div",{key:a,className:"col-md-4"},i.a.createElement(I,{index:a,key:a,value:r,newsFeeds:e.state.newsFeeds}))}))))}}]),t}(i.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[148,1,2]]]);
//# sourceMappingURL=main.6a19aded.chunk.js.map